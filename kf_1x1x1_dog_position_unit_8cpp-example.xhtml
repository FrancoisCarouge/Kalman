<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Kalman: kf_1x1x1_dog_position_unit.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Kalman<span id="projectnumber">&#160;0.4.0</span>
   </div>
   <div id="projectbrief">Kalman Filter</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.xhtml');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('kf_1x1x1_dog_position_unit_8cpp-example.xhtml',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">kf_1x1x1_dog_position_unit.cpp</div></div>
</div><!--header-->
<div class="contents">
<p>Estimating the position of a dog.</p>
<p>Estimating the position of a dog.</p><dl class="section copyright"><dt>Copyright</dt><dd>This example is transcribed from Kalman and Bayesian Filters in Python copyright Roger Labbe.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="https://github.com/rlabbe/Kalman-and-Bayesian-Filters-in-Python/blob/master/04-One-Dimensional-Kalman-Filters.ipynb">https://github.com/rlabbe/Kalman-and-Bayesian-Filters-in-Python/blob/master/04-One-Dimensional-Kalman-Filters.ipynb</a></dd></dl>
<p>Assume that in our latest hackathon someone created an RFID tracker that provides a reasonably accurate position of the dog. The sensor returns the distance of the dog from the left end of the hallway in meters. So, 23.4 would mean the dog is 23.4 meters from the left end of the hallway. The sensor is not perfect. A reading of 23.4 could correspond to the dog being at 23.7, or 23.0. However, it is very unlikely to correspond to a position of 47.6. Testing during the hackathon confirmed this result - the sensor is 'reasonably' accurate, and while it had errors, the errors are small. Furthermore, the errors seemed to be evenly distributed on both sides of the true position; a position of 23 m would equally likely be measured as 22.9 or 23.1. Perhaps we can model this with a Gaussian. We predict that the dog is moving. This prediction is not perfect. Sometimes our prediction will overshoot, sometimes it will undershoot. We are more likely to undershoot or overshoot by a little than a lot. Perhaps we can also model this with a Gaussian.</p>
<div class="fragment"><div class="line"><span class="comment">/*  __          _      __  __          _   _</span></div>
<div class="line"><span class="comment">| |/ /    /\   | |    |  \/  |   /\   | \ | |</span></div>
<div class="line"><span class="comment">| &#39; /    /  \  | |    | \  / |  /  \  |  \| |</span></div>
<div class="line"><span class="comment">|  &lt;    / /\ \ | |    | |\/| | / /\ \ | . ` |</span></div>
<div class="line"><span class="comment">| . \  / ____ \| |____| |  | |/ ____ \| |\  |</span></div>
<div class="line"><span class="comment">|_|\_\/_/    \_\______|_|  |_/_/    \_\_| \_|</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">Kalman Filter</span></div>
<div class="line"><span class="comment">Version 0.4.0</span></div>
<div class="line"><span class="comment">https://github.com/FrancoisCarouge/Kalman</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">SPDX-License-Identifier: Unlicense</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">This is free and unencumbered software released into the public domain.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">Anyone is free to copy, modify, publish, use, compile, sell, or</span></div>
<div class="line"><span class="comment">distribute this software, either in source code form or as a compiled</span></div>
<div class="line"><span class="comment">binary, for any purpose, commercial or non-commercial, and by any</span></div>
<div class="line"><span class="comment">means.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">In jurisdictions that recognize copyright laws, the author or authors</span></div>
<div class="line"><span class="comment">of this software dedicate any and all copyright interest in the</span></div>
<div class="line"><span class="comment">software to the public domain. We make this dedication for the benefit</span></div>
<div class="line"><span class="comment">of the public at large and to the detriment of our heirs and</span></div>
<div class="line"><span class="comment">successors. We intend this dedication to be an overt act of</span></div>
<div class="line"><span class="comment">relinquishment in perpetuity of all present and future rights to this</span></div>
<div class="line"><span class="comment">software under copyright law.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,</span></div>
<div class="line"><span class="comment">EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF</span></div>
<div class="line"><span class="comment">MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.</span></div>
<div class="line"><span class="comment">IN NO EVENT SHALL THE AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR</span></div>
<div class="line"><span class="comment">OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,</span></div>
<div class="line"><span class="comment">ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR</span></div>
<div class="line"><span class="comment">OTHER DEALINGS IN THE SOFTWARE.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">For more information, please refer to &lt;https://unlicense.org&gt; */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="kalman_8hpp.xhtml">fcarouge/kalman.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="unit_8hpp.xhtml">fcarouge/unit.hpp</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacefcarouge_1_1sample.xhtml">fcarouge::sample</a> {</div>
<div class="line"><span class="keyword">namespace </span>{</div>
<div class="line">[[maybe_unused]] <span class="keyword">auto</span> sample{[] {</div>
<div class="line">  <a id="a0" name="a0"></a><a class="code hl_function" href="namespacefcarouge.xhtml#ae4d1dbbab6a8bdcaa50062d0cb879777">kalman</a> filter{</div>
<div class="line">      <span class="comment">// This is the dog&#39;s initial position expressed as a Gaussian. The state X</span></div>
<div class="line">      <span class="comment">// position is 0 meters.</span></div>
<div class="line">      state{<a id="a1" name="a1"></a><a class="code hl_typedef" href="namespacefcarouge.xhtml#a0480c6f84be0a01264da3eb984c103e1">position</a>{1. * m}},</div>
<div class="line">      <span class="comment">// The measured output position Z.</span></div>
<div class="line">      output&lt;position&gt;,</div>
<div class="line">      <span class="comment">// We are predicting that at each time step the dog moves forward one</span></div>
<div class="line">      <span class="comment">// meter. This is the input U process model - the description of how we</span></div>
<div class="line">      <span class="comment">// think the dog moves. How do I know the velocity? Magic? Consider it a</span></div>
<div class="line">      <span class="comment">// prediction, or perhaps we have a secondary velocity sensor. Please</span></div>
<div class="line">      <span class="comment">// accept this simplification for now.</span></div>
<div class="line">      input&lt;position&gt;,</div>
<div class="line">      <span class="comment">// The variance to 400 m, which is a standard deviation of 20 meters. You</span></div>
<div class="line">      <span class="comment">// can think of this as saying &quot;I believe with 99.7% accuracy the position</span></div>
<div class="line">      <span class="comment">// is 0 plus or minus 60 meters&quot;. This is because with Gaussians ~99.7% of</span></div>
<div class="line">      <span class="comment">// values fall within of the mean. The estimate uncertainty P:</span></div>
<div class="line">      estimate_uncertainty{20. * m2},</div>
<div class="line">      <span class="comment">// Variance in the dog&#39;s movement. The process variance is how much error</span></div>
<div class="line">      <span class="comment">// there is in the process model. Dogs rarely do what we expect, and</span></div>
<div class="line">      <span class="comment">// things like hills or the whiff of a squirrel will change his progress.</span></div>
<div class="line">      <span class="comment">// The process uncertainty Q:</span></div>
<div class="line">      process_uncertainty{1. * m2},</div>
<div class="line">      <span class="comment">// Variance in the sensor. The meaning of sensor variance is how much</span></div>
<div class="line">      <span class="comment">// variance there is in each measurement. The output uncertainty R:</span></div>
<div class="line">      output_uncertainty{2. * m2}};</div>
<div class="line"> </div>
<div class="line">  filter.predict(<a class="code hl_typedef" href="namespacefcarouge.xhtml#a0480c6f84be0a01264da3eb984c103e1">position</a>{1. * m});</div>
<div class="line">  filter.update(<a class="code hl_typedef" href="namespacefcarouge.xhtml#a0480c6f84be0a01264da3eb984c103e1">position</a>{1.354 * m});</div>
<div class="line">  filter.predict(<a class="code hl_typedef" href="namespacefcarouge.xhtml#a0480c6f84be0a01264da3eb984c103e1">position</a>{2.352 * m});</div>
<div class="line">  filter.update(<a class="code hl_typedef" href="namespacefcarouge.xhtml#a0480c6f84be0a01264da3eb984c103e1">position</a>{1.882 * m});</div>
<div class="line">  filter.predict(<a class="code hl_typedef" href="namespacefcarouge.xhtml#a0480c6f84be0a01264da3eb984c103e1">position</a>{3.070 * m});</div>
<div class="line">  filter.update(<a class="code hl_typedef" href="namespacefcarouge.xhtml#a0480c6f84be0a01264da3eb984c103e1">position</a>{4.341 * m});</div>
<div class="line">  filter.predict(<a class="code hl_typedef" href="namespacefcarouge.xhtml#a0480c6f84be0a01264da3eb984c103e1">position</a>{4.736 * m});</div>
<div class="line">  filter.update(<a class="code hl_typedef" href="namespacefcarouge.xhtml#a0480c6f84be0a01264da3eb984c103e1">position</a>{7.156 * m});</div>
<div class="line">  filter.predict(<a class="code hl_typedef" href="namespacefcarouge.xhtml#a0480c6f84be0a01264da3eb984c103e1">position</a>{6.960 * m});</div>
<div class="line">  filter.update(<a class="code hl_typedef" href="namespacefcarouge.xhtml#a0480c6f84be0a01264da3eb984c103e1">position</a>{6.939 * m});</div>
<div class="line">  filter.predict(<a class="code hl_typedef" href="namespacefcarouge.xhtml#a0480c6f84be0a01264da3eb984c103e1">position</a>{7.949 * m});</div>
<div class="line">  filter.update(<a class="code hl_typedef" href="namespacefcarouge.xhtml#a0480c6f84be0a01264da3eb984c103e1">position</a>{6.844 * m});</div>
<div class="line">  filter.predict(<a class="code hl_typedef" href="namespacefcarouge.xhtml#a0480c6f84be0a01264da3eb984c103e1">position</a>{8.396 * m});</div>
<div class="line">  filter.update(<a class="code hl_typedef" href="namespacefcarouge.xhtml#a0480c6f84be0a01264da3eb984c103e1">position</a>{9.847 * m});</div>
<div class="line">  filter.predict(<a class="code hl_typedef" href="namespacefcarouge.xhtml#a0480c6f84be0a01264da3eb984c103e1">position</a>{10.122 * m});</div>
<div class="line">  filter.update(<a class="code hl_typedef" href="namespacefcarouge.xhtml#a0480c6f84be0a01264da3eb984c103e1">position</a>{12.553 * m});</div>
<div class="line">  filter.predict(<a class="code hl_typedef" href="namespacefcarouge.xhtml#a0480c6f84be0a01264da3eb984c103e1">position</a>{12.338 * m});</div>
<div class="line">  filter.update(<a class="code hl_typedef" href="namespacefcarouge.xhtml#a0480c6f84be0a01264da3eb984c103e1">position</a>{16.273 * m});</div>
<div class="line">  filter.predict(<a class="code hl_typedef" href="namespacefcarouge.xhtml#a0480c6f84be0a01264da3eb984c103e1">position</a>{15.305 * m});</div>
<div class="line">  filter.update(<a class="code hl_typedef" href="namespacefcarouge.xhtml#a0480c6f84be0a01264da3eb984c103e1">position</a>{14.8 * m});</div>
<div class="line"> </div>
<div class="line">  assert(</div>
<div class="line">      <a class="code hl_typedef" href="namespacefcarouge.xhtml#a0480c6f84be0a01264da3eb984c103e1">position</a>{15.052 * m} &lt; filter.x() &amp;&amp; filter.x() &lt; <a class="code hl_typedef" href="namespacefcarouge.xhtml#a0480c6f84be0a01264da3eb984c103e1">position</a>{15.054 * m} &amp;&amp;</div>
<div class="line">      <span class="stringliteral">&quot;Here we can see that the variance converges to 2.1623 in 9 steps. This &quot;</span></div>
<div class="line">      <span class="stringliteral">&quot;means that we have become very confident in our position estimate. It &quot;</span></div>
<div class="line">      <span class="stringliteral">&quot;is equal to meters. Contrast this to the sensor&#39;s meters.&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}()};</div>
<div class="line">} <span class="comment">// namespace</span></div>
<div class="line">} <span class="comment">// namespace fcarouge::sample</span></div>
<div class="ttc" id="akalman_8hpp_xhtml"><div class="ttname"><a href="kalman_8hpp.xhtml">kalman.hpp</a></div><div class="ttdoc">The Kalman filter class and library top-level header.</div></div>
<div class="ttc" id="anamespacefcarouge_1_1sample_xhtml"><div class="ttname"><a href="namespacefcarouge_1_1sample.xhtml">fcarouge::sample</a></div><div class="ttdoc">Examples, tutorials, demonstrators of the library.</div></div>
<div class="ttc" id="anamespacefcarouge_xhtml_a0480c6f84be0a01264da3eb984c103e1"><div class="ttname"><a href="namespacefcarouge.xhtml#a0480c6f84be0a01264da3eb984c103e1">fcarouge::position</a></div><div class="ttdeci">mp_units::quantity_point&lt; mp_units::isq::length[m]&gt; position</div><div class="ttdef"><b>Definition</b> <a href="unit_8hpp_source.xhtml#l00068">unit.hpp:68</a></div></div>
<div class="ttc" id="anamespacefcarouge_xhtml_ae4d1dbbab6a8bdcaa50062d0cb879777"><div class="ttname"><a href="namespacefcarouge.xhtml#ae4d1dbbab6a8bdcaa50062d0cb879777">fcarouge::kalman</a></div><div class="ttdeci">kalman(Arguments... arguments) -&gt; kalman&lt; internal::deduce_filter&lt; Arguments... &gt; &gt;</div><div class="ttdoc">Deduces the filter type from its declared configuration.</div></div>
<div class="ttc" id="aunit_8hpp_xhtml"><div class="ttname"><a href="unit_8hpp.xhtml">unit.hpp</a></div><div class="ttdoc">Quantities and units facade for mp-units third party implementation.</div></div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
